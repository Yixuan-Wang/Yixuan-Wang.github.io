<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script type="module" async="" crossorigin="" src="/assets/app.fd43facd.js"></script><style>button[data-v-d942ea9a]{padding:.25rem;font-size:1.125rem;line-height:1.75rem;color:rgba(var(--color-accent))}#app{display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:100%;margin-left:1rem;margin-right:1rem;height:100%}@media (min-width:1024px){#app{margin-left:0;margin-right:0}}*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}h1,h2{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}strong{font-weight:bolder}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}button{font-family:inherit;font-size:100%;line-height:inherit;color:inherit;margin:0;padding:0}button{text-transform:none}button{-webkit-appearance:button;background-color:transparent;background-image:none}h1,h2,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}button{cursor:pointer}*,::after,::before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-scroll-snap-strictness:proximity;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow:0 0 rgba(0,0,0,0);--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5)}.i-mdi-file,[i-mdi-file=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M13 9V3.5L18.5 9M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-folder=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M10 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-table-large=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M4 3h16a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m0 4v3h4V7H4m6 0v3h4V7h-4m10 3V7h-4v3h4M4 12v3h4v-3H4m0 8h4v-3H4v3m6-8v3h4v-3h-4m0 8h4v-3h-4v3m10 0v-3h-4v3h4m0-8h-4v3h4v-3Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-text-box=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M14 17H7v-2h7m3-2H7v-2h10m0-2H7V7h10m2-4H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[btn-icon=""]:hover{color:rgba(var(--color-accent));transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.transition-lively,[btn-icon=""],[transition-lively=""]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,1,1)}.transition-lively:hover,[transition-lively=""]:hover{transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-8,[m~=b-8]{margin-bottom:2rem}.mt-4,[m~=t-4]{margin-top:1rem}.inline-block{display:inline-block}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{grid-gap:.25rem;gap:.25rem}.gap-2{grid-gap:.5rem;gap:.5rem}.gap-3{grid-gap:.75rem;gap:.75rem}.gap-x-1{grid-column-gap:.25rem;column-gap:.25rem}.gap-y-0\.5{grid-row-gap:.125rem;row-gap:.125rem}.rounded{border-radius:.25rem}.hover\:bg-acc:hover,[bg~=acc]{background-color:rgba(var(--color-accent))}.hover\:bg-sec:hover,[bg~="hover\:sec"]:hover{background-color:rgba(var(--color-secondary))}.p-1{padding:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.text-left{text-align:left}.font-mono,[font~=mono]{font-family:var(--font-mono)}.text-xs{font-size:.75rem;line-height:1rem}.font-bold,[font~=bold]{font-weight:700}[color~="\#00aba9"]{--un-text-opacity:1;color:rgba(0,171,169,var(--un-text-opacity))}.text-acc{color:rgba(var(--color-accent))}.hover\:text-bgd:hover,[text~=bgd]{color:rgba(var(--color-background))}.hover\:text-sec:hover,.text-sec{color:rgba(var(--color-secondary))}.text-dim{color:rgba(var(--color-dim))}:root{--shiki-color-text:#EEEEEE;--shiki-color-background:#333333;--shiki-token-constant:#660000;--shiki-token-string:#770000;--shiki-token-comment:#880000;--shiki-token-keyword:#990000;--shiki-token-parameter:#AA0000;--shiki-token-function:#BB0000;--shiki-token-string-expression:#CC0000;--shiki-token-punctuation:#DD0000;--shiki-token-link:#EE0000}:root{--font-sans:"Noto Sans",var(--custom-font-sans, sans-serif),"SF Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Avenir Next","Helvetica Neue",sans-serif;--font-serif:"Noto Serif",var(--custom-font-serif, serif),"Noto Serif","New York","Roboto Slab",Cambria,Georgia,Times,"Times New Roman",serif;--font-mono:"JetBrains Mono","SF Mono","Roboto Mono",Menlo,"Cascadia Code",Consolas,monospace}html:not(.dark){--color-accent-default:33,119,184;--color-accent:var(--accent-light-accent, var(--color-accent-default));--color-secondary-default:0,58,112;--color-secondary:var(--accent-light-secondary, var(--color-secondary-default));--color-background:245,245,245;--color-foreground:29,37,45;--color-dim:115,125,124}html{height:100%;width:100%;margin:0;padding:0;text-align:center;font-size:1rem;line-height:1.5rem;overflow-x:hidden;overflow-y:auto;overflow-y:overlay;background-color:rgba(var(--color-background));color:rgba(var(--color-foreground));font-family:var(--font-sans)}body{height:100%;margin:auto;padding:0;max-width:75ch}code,pre{font-family:var(--font-mono)}h1{font-size:1.875rem;line-height:2.25rem;font-weight:700}button{outline:2px solid transparent!important;outline-offset:2px!important}#md a{color:rgba(var(--color-accent));background-color:rgba(var(--color-accent),.125);border-radius:.25rem;padding:.125rem .5ch;transition:all .2s ease-in}#md a:hover{color:rgba(var(--color-secondary));background-color:rgba(var(--color-secondary),.25);transition:all .3s ease-out}#md h2{margin:1.25em 0 .75em;font-family:var(--font-serif);font-weight:700}#md h2{font-size:1.5em}#md p{margin:1em 0}#md h2:first-child,#md p:first-child,#md pre:first-child{margin-top:0}#md h2:last-child,#md p:last-child,#md pre:last-child{margin-bottom:0}#md ul{margin:1em 0;padding-left:1em}#md ul{list-style:disc}#md li{line-height:150%;margin:.25em 0}#md pre{border-radius:.25rem;padding:1em;max-width:100%;overflow:auto}#md p code{font-size:.95rem}#md code,#md pre{font-family:var(--font-mono);line-height:154%}#md code:not(precode,acode){background-color:rgba(var(--color-dim),.25);border-radius:.25rem;padding:.125rem .5ch}#md pre{margin:1em 0}#md .katex{font-size:1em}</style><link rel="preload" href="/assets/app.1c722c82.css" as="style"><link rel="modulepreload" crossorigin="" href="/assets/dsa_del-bst.f0b077bc.js"><link rel="modulepreload" crossorigin="" href="/assets/TheArticle.9265727a.js"><title>二叉搜索树的删除结点操作 | Pak</title><meta name="description" content="二叉搜索树删除结点的操作实际上是一种旋转。"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous"><meta name="head:count" content="2"></head><body><div id="app" data-server-rendered="true"><!--[--><header class="flex justify-between items-center my-4 gap-2" data-v-d942ea9a=""><nav class="inline-block px-2 py-1 rounded transition-lively" text="bgd" bg="acc hover:sec" font="mono bold" data-v-d942ea9a=""><a href="/" class="" data-v-d942ea9a="">pαk</a></nav><nav class="flex justify-between items-center gap-3" data-v-d942ea9a=""><button transition-lively="" class="hover:text-sec" data-v-d942ea9a=""><a href="/archive" class="" data-v-d942ea9a=""><div i-mdi-text-box="" data-v-d942ea9a=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-d942ea9a=""><a href="/posts" class="" data-v-d942ea9a=""><div i-mdi-file="" data-v-d942ea9a=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-d942ea9a=""><a href="/sheets" class="" data-v-d942ea9a=""><div i-mdi-table-large="" data-v-d942ea9a=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-d942ea9a=""><a href="/notes" class="" data-v-d942ea9a=""><div i-mdi-folder="" data-v-d942ea9a=""></div></a></button></nav></header><main class="text-left"><main class="mb-8"><article class="text-left"><header class="flex flex-col justify-start items-start gap-2 mt-4 mb-8"><h1>二叉搜索树的删除结点操作</h1><div class="flex flex-wrap gap-x-1 gap-y-0.5 justify-start items-center"><span class="flex justify-center"><button btn-icon=""><a href="/posts" class=""><div class="i-mdi-file"></div></a></button></span><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively"><!--[--><time>2020/09/18</time><!--]--></span></span><!--[--><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-acc hover:bg-acc hover:text-bgd"><!--[--><a href="/categories/comp" class="">comp</a><!--]--></span></span><span class="flex gap-1 justify-center items-center"><!--[--><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-sec hover:bg-sec hover:text-bgd"><!--[--><a href="/tags?tag=dsa" class=""> @dsa</a><!--]--></span><!--]--></span><span class="flex gap-1 justify-center items-center"><!--[--><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-dim"><!--[--><span> #bst</span><!--]--></span><!--]--></span><!--]--></div></header><nav m="t-4 b-8"><ul><!--[--><!--]--></ul></nav><article id="md"><div><p>二叉搜索树删除结点的操作实际上是一种旋转。</p><!-- more --><div style="text-align:center"><strong><del>生活在二叉树上</del></strong><br>P市一辣鸡</div><p>用二叉树的数据结构体现存取增减最优都能达到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>的超越性，保持婞直却又不拘泥于所谓“顺序表二分查找”的单向度形象。这便是二叉搜索树为我们提供的理想期望数据结构范式。<s>生活在二叉树上——始终热爱全序——升上根结点</s>。</p><h2 id="二叉搜索树" tabindex="-1">二叉搜索树</h2><p>回归正题。数据结构与算法 B 课程期末考试考到了二叉搜索树删除结点，自觉答得不够清晰完整，这里补充上，算是填补一下遗憾。</p><p>二叉搜索树是<strong>中序遍历权值序列单调不降</strong>（或不增）的二叉树。任意一个结点，左子的权值（若存在，下同）小于等于它，右子的权值大于等于它（反过来当然也可以）。而二叉堆则是任意一个结点，左子和右子权值都大于等于它（或小于等于）。</p><p>所以二叉搜索树任意一棵左右子树也都是二叉搜索树。特别无聊地，空树也是二叉搜索树。</p><h2 id="删除结点" tabindex="-1">删除结点</h2><p>为了维护二叉搜索树的顺序关系，删除一个结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">o</span></span></span></span>以后，要用左子树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">L</span></span></span></span>最大的结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">l_{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>（也就是<strong>最右下的结点</strong>）替换<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">o</span></span></span></span>。如果没有左子树，也就是图 b 的情况，直接把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span></span></span></span>变为父结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span></span></span></span>的子树即可。</p><div style="display:flex;flex-wrap:wrap"><pre style="flex:1 1">[a]
 p
  \
   o
  / \
 L   R
</pre>&nbsp;<pre style="flex:1 1">[b]
 p
  \
   o
    \
     R  
</pre></div><pre class="shiki" style="background-color:#282c34"><code><span class="line"><span style="color:#7f848e;font-style:italic"># 二叉搜索树类的 delete 方法</span></span>
<span class="line"></span>
<span class="line"><span style="color:#c678dd">def</span><span style="color:#abb2bf"> </span><span style="color:#61afef">delete</span><span style="color:#abb2bf">(</span><span style="color:#e5c07b;font-style:italic">self</span><span style="color:#abb2bf">, </span><span style="color:#d19a66;font-style:italic">key</span><span style="color:#abb2bf">):</span></span>
<span class="line"><span style="color:#abb2bf">    current </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#e5c07b">self</span><span style="color:#abb2bf">._root </span><span style="color:#7f848e;font-style:italic"># current 根结点，设为当前结点</span></span>
<span class="line"><span style="color:#abb2bf">    fa </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf"> </span><span style="color:#7f848e;font-style:italic"># fa[ther] 当前结点的父结点</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">    order </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#e5c07b">self</span><span style="color:#abb2bf">.order </span><span style="color:#7f848e;font-style:italic"># 全序关系函数 order(a, b) -&gt; Bool，二叉搜索树满足 order(左子，自己) == True</span></span>
<span class="line"><span style="color:#abb2bf">    equal </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#e5c07b">self</span><span style="color:#abb2bf">.equal </span><span style="color:#7f848e;font-style:italic"># 相等关系函数 equal(a, b) -&gt; Bool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd;font-style:italic">while</span><span style="color:#abb2bf"> current </span><span style="color:#56b6c2">!=</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf">:</span></span>
<span class="line"><span style="color:#abb2bf">        </span><span style="color:#c678dd;font-style:italic">if</span><span style="color:#abb2bf"> </span><span style="color:#61afef">equal</span><span style="color:#abb2bf">(key, current.key): </span><span style="color:#7f848e;font-style:italic"># 当前结点就是目标结点</span></span>
<span class="line"><span style="color:#abb2bf">            </span><span style="color:#c678dd;font-style:italic">if</span><span style="color:#abb2bf"> current.lch </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf">: </span><span style="color:#7f848e;font-style:italic"># l[eft]ch[ild] 左子 左子为空</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">if</span><span style="color:#abb2bf"> fa </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf">: </span><span style="color:#e5c07b">self</span><span style="color:#abb2bf">._root </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.rch </span><span style="color:#7f848e;font-style:italic"># 若要删除的是根结点，且没有左子树</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">elif</span><span style="color:#abb2bf"> fa.lch </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> current: fa.lch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.rch </span><span style="color:#7f848e;font-style:italic"># 当前是父结点的左子，用当前的右子替换当前结点</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">else</span><span style="color:#abb2bf">: fa.rch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.rch </span><span style="color:#7f848e;font-style:italic"># 当前是父结点右子，同上</span></span>
<span class="line"><span style="color:#abb2bf">            </span><span style="color:#c678dd;font-style:italic">else</span><span style="color:#abb2bf">:</span></span>
<span class="line"><span style="color:#abb2bf">                rightmost </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.lch </span><span style="color:#7f848e;font-style:italic"># rightmost 左子树最大结点，初始化为左子</span></span>
<span class="line"><span style="color:#abb2bf">                faRightmost </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current </span><span style="color:#7f848e;font-style:italic"># fa[ther-of-]Rightmost 左子树最大结点的父结点，初始化为当前结点</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">while</span><span style="color:#abb2bf"> rightmost.rch </span><span style="color:#56b6c2">!=</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf">: faRightmost, rightmost </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost, rightmost.rch</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#7f848e;font-style:italic"># 循环找最右下结点</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">if</span><span style="color:#abb2bf"> faRightmost </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> current: faRightmost.lch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost.lch </span><span style="color:#7f848e;font-style:italic"># 当前结点左子的右子树为空，用左子的左子替代左子</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">else</span><span style="color:#abb2bf">: faRightmost.rch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost.lch </span><span style="color:#7f848e;font-style:italic"># 最大结点用左子替代</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">                rightmost.lch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.lch </span><span style="color:#7f848e;font-style:italic"># 替换最右下结点的子结点引用</span></span>
<span class="line"><span style="color:#abb2bf">                rightmost.rch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current.rch</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">if</span><span style="color:#abb2bf"> fa </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> </span><span style="color:#d19a66">None</span><span style="color:#abb2bf">: </span><span style="color:#e5c07b">self</span><span style="color:#abb2bf">._root </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost </span><span style="color:#7f848e;font-style:italic"># 若当前结点是根节点，不用改变父的子结点引用</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">elif</span><span style="color:#abb2bf"> fa.lch </span><span style="color:#56b6c2">==</span><span style="color:#abb2bf"> current: fa.lch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost </span><span style="color:#7f848e;font-style:italic"># 替换当前结点父结点的子结点引用</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#c678dd;font-style:italic">else</span><span style="color:#abb2bf">: fa.rch </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> rightmost</span></span>
<span class="line"><span style="color:#abb2bf">                </span><span style="color:#7f848e;font-style:italic"># 左子树上最大结点替代当前结点</span></span>
<span class="line"></span>
<span class="line"><span style="color:#abb2bf">            </span><span style="color:#c678dd;font-style:italic">del</span><span style="color:#abb2bf"> current </span><span style="color:#7f848e;font-style:italic"># 删除当前结点</span></span>
<span class="line"><span style="color:#abb2bf">            </span><span style="color:#c678dd;font-style:italic">return</span></span>
<span class="line"><span style="color:#abb2bf">        </span><span style="color:#c678dd;font-style:italic">elif</span><span style="color:#abb2bf"> </span><span style="color:#61afef">order</span><span style="color:#abb2bf">(key, current.key): fa, current </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current, current.lch </span><span style="color:#7f848e;font-style:italic"># 找目标结点</span></span>
<span class="line"><span style="color:#abb2bf">        </span><span style="color:#c678dd;font-style:italic">else</span><span style="color:#abb2bf">: fa, current </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> current, current.rch</span></span>
<span class="line"></span></code></pre><h2 id="旋转" tabindex="-1">旋转</h2><p>课程里没有提及旋转的概念。后来一位前 OIer 朋友（<a href="https://www.cnblogs.com/FYH-SSGSS/" target="_blank" rel="noopener">@FYH</a>）给我科普，以上删除结点的操作其实涉及到了旋转。</p><p>对于以下两棵二叉搜索树：</p><div style="display:flex;flex-wrap:wrap"><pre style="flex:1 1">[a]
    3*
   / \
  2   4
 /     \
1       5
</pre>&nbsp;<pre style="flex:1 1">[b]
 1
  \   
   2
    \
     3*
      \
       4
        \
         5
</pre></div><p>存储的数据是完全相同的，但是树 a 中搜索的最坏时间复杂度达到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，树 b 中搜索则达到了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。二叉树构造得越“平衡”，在其上进行操作的性能就越好。为了使 b 变得更平衡，可以以标 <code>*</code> 的 3 号结点为新的根结点，将它的祖先结点<strong>旋转</strong>为它的左子树，变成树 a。</p><p>同样地，二叉搜索树删除结点操作也可以视为以待删除结点左子树的最大结点为中心，将待删除结点的左子树旋转为它的左子树，再将待删除结点的右子树接在旋转的中心上。</p><h2 id="参考资料" tabindex="-1">参考资料</h2><ul><li>OI Wiki，<a href="https://oi-wiki.org/ds/bst/" target="_blank" rel="noopener">二叉搜索树</a></li><li>裘宗燕，数据结构与算法：Python 语言描述，2018</li></ul></div></article></article></main></main><!----><!--]--></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><script>!function(){var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("color-scheme")||"auto",t=(document.documentElement.className="dark"===a||t&&"light"!==a?"dark":"",localStorage.getItem("typesetting::accent_color"));if(t){a=JSON.parse(t),t=Object.entries(a).map(e=>`--accent-${e[0]}: ${e[1]};`).join("\n");let e=document.createElement("style");e.type="text/css",e.innerText=`:root{${t}}`,document.head.appendChild(e)}}()</script><link rel="stylesheet" href="/assets/app.1c722c82.css"></body></html>