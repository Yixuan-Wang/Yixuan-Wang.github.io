<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script type="module" async="" crossorigin="" src="/assets/app.926e3245.js"></script><style>button[data-v-adef6890]{padding:.25rem;font-size:1.125rem;line-height:1.75rem;color:var(--color-accent)}button[data-v-adef6890]:hover{color:var(--color-secondary)}#app{display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:100%;margin-left:1rem;margin-right:1rem;height:100%}@media (min-width:1024px){#app{margin-left:0;margin-right:0}}*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}h1,h2{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}strong{font-weight:bolder}code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}button{font-family:inherit;font-size:100%;line-height:inherit;color:inherit;margin:0;padding:0}button{text-transform:none}button{-webkit-appearance:button;background-color:transparent;background-image:none}h1,h2,p{margin:0}ol{list-style:none;margin:0;padding:0}button{cursor:pointer}*,::after,::before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-scroll-snap-strictness:proximity;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow:0 0 rgba(0,0,0,0);--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5)}.i-mdi-file,[i-mdi-file=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M13 9V3.5L18.5 9M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-folder=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M10 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-table-large=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M4 3h16a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m0 4v3h4V7H4m6 0v3h4V7h-4m10 3V7h-4v3h4M4 12v3h4v-3H4m0 8h4v-3H4v3m6-8v3h4v-3h-4m0 8h4v-3h-4v3m10 0v-3h-4v3h4m0-8h-4v3h4v-3Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-text-box=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M14 17H7v-2h7m3-2H7v-2h10m0-2H7V7h10m2-4H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[btn-icon=""]:hover{color:var(--color-accent);transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.transition-lively,[btn-icon=""],[transition-lively=""]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,1,1)}.transition-lively:hover,[transition-lively=""]:hover{transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mt-4{margin-top:1rem}.inline-block{display:inline-block}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{grid-gap:.25rem;gap:.25rem}.gap-2{grid-gap:.5rem;gap:.5rem}.gap-3{grid-gap:.75rem;gap:.75rem}.gap-x-1{grid-column-gap:.25rem;column-gap:.25rem}.gap-y-0\.5{grid-row-gap:.125rem;row-gap:.125rem}.rounded{border-radius:.25rem}.hover\:bg-acc:hover,[bg~=acc]{background-color:var(--color-accent)}.hover\:bg-sec:hover,[bg~="hover\:sec"]:hover{background-color:var(--color-secondary)}.p-1{padding:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.text-left{text-align:left}.font-mono,[font~=mono]{font-family:var(--font-mono)}.text-xs{font-size:.75rem;line-height:1rem}.font-bold,[font~=bold]{font-weight:700}.text-acc{color:var(--color-accent)}.hover\:text-bgd:hover,[text~=bgd]{color:var(--color-background)}.hover\:text-sec:hover,.text-sec{color:var(--color-secondary)}[color~="\#00aba9"]{--un-text-opacity:1;color:rgba(0,171,169,var(--un-text-opacity))}:root{--font-sans:"Noto Sans",var(--custom-font-sans, sans-serif),"SF Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Avenir Next","Helvetica Neue",sans-serif;--font-serif:"Noto Serif",var(--custom-font-serif, serif),"Noto Serif","New York","Roboto Slab",Cambria,Georgia,Times,"Times New Roman",serif;--font-mono:"JetBrains Mono","SF Mono","Roboto Mono",Menlo,"Cascadia Code",Consolas,monospace}html:not(.dark){--color-accent:var(--accent-light-accent, #003A70);--color-secondary:var(--accent-light-secondary, #61649f);--color-background:#F5F5F5;--color-foreground:#1D252D;--color-dim:#737C7B}html{height:100%;width:100%;margin:0;padding:0;text-align:center;font-size:1rem;line-height:1.5rem;overflow-x:hidden;overflow-y:auto;overflow-y:overlay;background-color:var(--color-background);color:var(--color-foreground);font-family:var(--font-sans)}body{height:100%;margin:auto;padding:0;max-width:75ch}h1{font-size:1.875rem;line-height:2.25rem;font-weight:700}button{outline:2px solid transparent!important;outline-offset:2px!important}#md a,#md a *{text-decoration-skip-ink:auto;color:var(--color-accent);transition:all .2s ease-in}#md a :hover,#md a:hover{color:var(--color-secondary);transition:all .3s ease-out}#md em{padding-right:.25ch}#md h2{margin:1.25em 0 .75em;font-family:var(--font-serif);font-weight:700}#md h2{font-size:1.5em}#md p{margin:1em 0}#md h2:first-child,#md p:first-child{margin-top:0}#md h2:last-child,#md p:last-child{margin-bottom:0}#md a{text-decoration:underline;text-decoration-skip-ink:auto}#md ol{margin:1em 0;padding-left:1em}#md ol{list-style:decimal}#md li{line-height:150%;margin:.25em 0}#md p code{font-size:.95rem;padding:.2em}#md code{font-family:var(--font-mono);line-height:154%}</style><link rel="preload" href="/assets/app.20db8728.css" as="style"><link rel="modulepreload" crossorigin="" href="/assets/essay_blogging-tech.b8028388.js"><link rel="modulepreload" crossorigin="" href="/assets/TheArticle.2efce49e.js"><title>搭建博客的技术性思考 | Pak</title><meta name="description" content="搭建静态博客时考虑的技术的的问题。"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous"><meta name="head:count" content="2"></head><body><div id="app" data-server-rendered="true"><!--[--><header class="flex justify-between items-center my-4 gap-2" data-v-adef6890=""><nav class="inline-block px-2 py-1 rounded transition-lively" text="bgd" bg="acc hover:sec" font="mono bold" data-v-adef6890=""><a href="/" class="" data-v-adef6890="">pαk</a></nav><nav class="flex justify-between items-center gap-3" data-v-adef6890=""><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/archive" class="" data-v-adef6890=""><div i-mdi-text-box="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/posts" class="" data-v-adef6890=""><div i-mdi-file="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/sheets" class="" data-v-adef6890=""><div i-mdi-table-large="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/notes" class="" data-v-adef6890=""><div i-mdi-folder="" data-v-adef6890=""></div></a></button></nav></header><main class="text-left"><main class="mb-8"><article class="text-left"><header class="flex flex-col justify-start items-start gap-2 mt-4 mb-8"><h1>搭建博客的技术性思考</h1><div class="flex flex-wrap gap-x-1 gap-y-0.5 justify-start items-center"><span class="flex justify-center"><button btn-icon=""><a href="/posts" class=""><div class="i-mdi-file"></div></a></button></span><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively"><!--[--><time>2020/10/11</time><!--]--></span></span><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-acc hover:bg-acc hover:text-bgd"><!--[--><a href="/categories/misc" class="">misc</a><!--]--></span></span><span class="flex gap-1 justify-center items-center"><!--[--><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-sec hover:bg-sec hover:text-bgd"><!--[--><a href="/tags?tag=essay" class=""> @essay</a><!--]--></span><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-sec hover:bg-sec hover:text-bgd"><!--[--><a href="/tags?tag=frontend" class=""> @frontend</a><!--]--></span><!--]--></span><span class="flex gap-1 justify-center items-center"><!--[--><!--]--></span></div></header><article id="md"><div><p>搭建静态博客时考虑的技术的的问题。</p><!-- more --><p><strong>更新（2021-01-09）</strong>：又重写了博客。本文已经<strong>非常过时</strong>。</p><p><strong>更新（2021-02-14）</strong>：更换为 Gatsby 生成器后，本文内容已经<strong>过时</strong>。</p><p>纯前端的静态网站加载速度应当都是快于 WordPress 等后端渲染方案的，而且还能节省下服务器的费用。所以这里主要谈静态的博客。</p><h2 id="托管" tabindex="-1">托管</h2><p>由于 <em>某些</em> 原因，在 ECS 上托管博客并不是个稳妥的选择。因此还是选择静态网站托管商。GitHub Pages 显然是<strong>最方便直接</strong>的选择，因为：</p><ol><li>GitHub 是一家较为可信的公司（不容易跑路，且服务质量高）</li><li>GitHub Pages 免费，且功能完整</li></ol><p>但是出于 <em>某些</em> 原因，其访问不稳定。因此有必要考虑一个备选方案。</p><p>Vercel 专职提供静态网站托管，而且支持从 GitHub 仓库直接部署。但 Vercel 访问速度不够快。</p><p>Gitee 也提供静态网站托管服务（需要实名认证），但免费版不支持随 git 提交自动部署，只能手动部署。而且 Gitee 不支持托管某些格式的文件（比如 .txt），此外，有时还会有奇怪的文字编码问题。它的<strong>最大优势就是速度快</strong>。另在 Gitee 上部署一份镜像是可行的方案。</p><h2 id="部署" tabindex="-1">部署</h2><p><strong>更新（2021-02-15）</strong>：换用 Gatsby 以后不再使用<strong>绝对链接</strong>，替换步骤可以省略了😊。</p><p>把部署成品所在的文件夹设为 git 仓库，再上传到 GitHub。我使用的生成器没有提供部署到远程的功能，所以手写了一个脚本，把部署和 git 推送到远程服务器两个步骤绑在一起。</p><p>GitHub Action 在提交后触发，制作镜像（很不优雅）：</p><ol><li>检出仓库 <code>master</code> 分支的最新一次提交到 <code>master</code> 文件夹。注意，此时在 CD 服务器上的仓库里只有这一次提交，没有 <code>master</code> 分支以往的提交和其他分支，但远程服务器（<code>remote</code>）则绑定好了 GitHub 仓库的 <code>master</code> 分支。</li><li>检出仓库 <code>gitee</code> 分支的最新一次提交到 <code>gitee</code> 文件夹，这时分支的远程服务器就是 <code>gitee</code> 分支。</li><li>土味替换 🤦‍：把 <code>gitee/.git</code> 文件夹取出来，删掉 <code>master/.git</code> 文件夹，再删掉 <code>gitee</code> 文件夹（如果直接覆盖，可能有一部分存在于旧版本而不存在于新版本的文件被保留下来，因此必须清空），再把 <code>master</code> 文件夹拷贝到 <code>gitee</code> 文件夹（其实就是重命名），最后把之前取出来的 <code>gitee/.git</code> 放回去。</li><li>部署成品里面用于页面间导航的 URL 设成了绝对路径，要把所有 URL 中的 <code>{username}.github.io/blog/</code> 替换成 <code>{username}.gitee.io/blog/</code>。</li><li>提交到 <code>gitee</code> 分支。</li><li>使用第三方 Action 将库镜像到 Gitee，并触发 Gitee Pages 部署 <code>gitee</code> 分支。</li></ol><p>同时，GitHub Pages 会自动部署 <code>master</code> 分支。</p><h2 id="静态网站生成器" tabindex="-1">静态网站生成器</h2><p>静态网站生成器多种多样，选用哪一个比较见仁见智，因此放在最后。对于个人来说，我目前使用的是 <a href="https://gohugo.io" target="_blank" rel="noopener"><strong>Hugo</strong></a>。</p><p>不过它也有十分显著的缺点：</p><ol><li>接口设计复杂，引入了不少术语，经常需要翻阅文档。</li><li>文档内容比较简略，有时一笔带过。</li><li>如果需要修改主题，需要一定的 Golang 基础。Golang 的模板语法个人认为有些诡异。</li><li>社区不够活跃，生态不够完整。虽然主题较多，但是插件比较少，网上的教程也不多（尤其缺乏中文教程）。</li><li>Markdown 渲染能力差。Golang 自带的 Markdown 渲染器虽然快，但功能不全，且不够稳定，最后我换用了外置 Pandoc 进行渲染。</li></ol><p>因此我选中并维持在 Hugo 主要是看中了它的速度。不过，随着折腾和自定义的欲望增加，我也考虑过迁移，<s>只不过出于爱护肝而选择了继续苟在 Hugo</s>（已经迁移了 ::真香::）。</p><p><a href="https://theme-next.js.org" target="_blank" rel="noopener"><strong>NexT 主题</strong></a>基本上由开发者<ruby>包办<rt>bào gān</rt></ruby>了一切，包括评论系统、数学公式，等等，都已经内置好了，教程也十分详细，唯一的缺点就是用的人实在是太多了，可能不够彰显个性。我曾经尝试过 NexT 主题，在规模很小的时候，和 Hugo 速度差异并不显著。</p><p><strong>Vuepress</strong> 是 Vue 官方推出的生成器，主要用于制作 Vue 文档，不过也可以生成博客。我曾经尝试过，似乎在性能方面问题更严重（和 Hugo 采用类似主题而仅有少量测试内容的情况下，启动耗时 7 秒），而且热加载之前似乎存在一些问题（这次测试似乎正常，速度也是 0.1 毫秒量级），因此放弃。</p><p>如果想要在博客中如果需要超高的自由度<s>且不再需要肝</s>，Gatsby / Gridsome 应该是首选。</p><p>至于 GitHub Pages 自带的 Jekyll，Jekyll 是基于 Ruby 语言的，Ruby 语言似乎在走下坡路，因而感觉 Jekyll 的前途也有些灰暗。而基于 Python 的 Pelican 和 MkDocs 我没有试过，不过据 OI Wiki 团队说 <a href="https://github.com/OI-wiki/OI-wiki/issues/1956" target="_blank" rel="noopener">MkDocs 自由度不够，在考虑换用 Gatsby</a>。</p><p>其他的生成器我没有了解过，在这里就不讨论了。</p></div></article></article></main></main><!----><!--]--></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><script>!function(){var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("color-scheme")||"auto",t=(document.documentElement.className="dark"===a||t&&"light"!==a?"dark":"",localStorage.getItem("typesetting::accent_color"));if(t){a=JSON.parse(t),t=Object.entries(a).map(e=>`--accent-${e[0]}: ${e[1]};`).join("\n");let e=document.createElement("style");e.type="text/css",e.innerText=`:root{${t}}`,document.head.appendChild(e)}}()</script><link rel="stylesheet" href="/assets/app.20db8728.css"></body></html>