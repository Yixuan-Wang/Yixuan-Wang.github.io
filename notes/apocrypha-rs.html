<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script type="module" async="" crossorigin="" src="/assets/app.c736d4e5.js"></script><style>button[data-v-adef6890]{padding:.25rem;font-size:1.125rem;line-height:1.75rem;color:var(--color-accent)}button[data-v-adef6890]:hover{color:var(--color-secondary)}#app{display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:100%;margin-left:1rem;margin-right:1rem;height:100%}@media (min-width:1024px){#app{margin-left:0;margin-right:0}}*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}h1,h2{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}strong{font-weight:bolder}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}button{font-family:inherit;font-size:100%;line-height:inherit;color:inherit;margin:0;padding:0}button{text-transform:none}button{-webkit-appearance:button;background-color:transparent;background-image:none}blockquote,h1,h2,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}button{cursor:pointer}*,::after,::before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-scroll-snap-strictness:proximity;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow:0 0 rgba(0,0,0,0);--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5)}[i-mdi-file=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M13 9V3.5L18.5 9M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}.i-mdi-folder,[i-mdi-folder=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M10 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-table-large=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M4 3h16a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m0 4v3h4V7H4m6 0v3h4V7h-4m10 3V7h-4v3h4M4 12v3h4v-3H4m0 8h4v-3H4v3m6-8v3h4v-3h-4m0 8h4v-3h-4v3m10 0v-3h-4v3h4m0-8h-4v3h4v-3Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[i-mdi-text-box=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' vertical-align='sub' width='1.25em' height='1.25em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M14 17H7v-2h7m3-2H7v-2h10m0-2H7V7h10m2-4H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;vertical-align:sub;width:1.25em;height:1.25em}[btn-icon=""]:hover{color:var(--color-accent);transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.transition-lively,[btn-icon=""],[transition-lively=""]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,1,1)}.transition-lively:hover,[transition-lively=""]:hover{transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1)}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-8,[m~=b-8]{margin-bottom:2rem}.mt-4,[m~=t-4]{margin-top:1rem}.inline-block{display:inline-block}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{grid-gap:.25rem;gap:.25rem}.gap-2{grid-gap:.5rem;gap:.5rem}.gap-3{grid-gap:.75rem;gap:.75rem}.gap-x-1{grid-column-gap:.25rem;column-gap:.25rem}.gap-y-0\.5{grid-row-gap:.125rem;row-gap:.125rem}.rounded{border-radius:.25rem}.hover\:bg-acc:hover,[bg~=acc]{background-color:var(--color-accent)}.hover\:bg-sec:hover,[bg~="hover\:sec"]:hover{background-color:var(--color-secondary)}.p-1{padding:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.text-left{text-align:left}.font-mono,[font~=mono]{font-family:var(--font-mono)}.text-xs{font-size:.75rem;line-height:1rem}.font-bold,[font~=bold]{font-weight:700}.text-acc{color:var(--color-accent)}.hover\:text-bgd:hover,[text~=bgd]{color:var(--color-background)}.hover\:text-sec:hover,.text-sec{color:var(--color-secondary)}.text-dim{color:var(--color-dim)}[color~="\#00aba9"]{--un-text-opacity:1;color:rgba(0,171,169,var(--un-text-opacity))}:root{--font-sans:"Noto Sans",var(--custom-font-sans, sans-serif),"SF Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Avenir Next","Helvetica Neue",sans-serif;--font-serif:"Noto Serif",var(--custom-font-serif, serif),"Noto Serif","New York","Roboto Slab",Cambria,Georgia,Times,"Times New Roman",serif;--font-mono:"JetBrains Mono","SF Mono","Roboto Mono",Menlo,"Cascadia Code",Consolas,monospace}html:not(.dark){--color-accent:var(--accent-light-accent, #2177B8);--color-secondary:var(--accent-light-secondary, #003A70);--color-background:#F5F5F5;--color-foreground:#1D252D;--color-dim:#737C7B}html{height:100%;width:100%;margin:0;padding:0;text-align:center;font-size:1rem;line-height:1.5rem;overflow-x:hidden;overflow-y:auto;overflow-y:overlay;background-color:var(--color-background);color:var(--color-foreground);font-family:var(--font-sans)}html:not(.dark) .shiki-dark{display:none}body{height:100%;margin:auto;padding:0;max-width:75ch}code,pre{font-family:var(--font-mono)}h1{font-size:1.875rem;line-height:2.25rem;font-weight:700}button{outline:2px solid transparent!important;outline-offset:2px!important}#md a,#md a *{text-decoration-skip-ink:auto;color:var(--color-accent);transition:all .2s ease-in}#md a :hover,#md a:hover{color:var(--color-secondary);transition:all .3s ease-out}#md em{padding-right:.25ch}#md h2{margin:1.25em 0 .75em;font-family:var(--font-serif);font-weight:700}#md article[note]{margin:1.25em 0}#md h2{font-size:1.5em}#md p{margin:1em 0}#md h2:first-child,#md p:first-child,#md pre:first-child{margin-top:0}#md h2:last-child,#md p:last-child,#md pre:last-child{margin-bottom:0}#md a{text-decoration:underline;text-decoration-skip-ink:auto}#md blockquote{border-left:4px solid var(--color-foreground);padding-left:1em;margin-left:0;margin-top:0}#md blockquote p{margin-bottom:0}#md pre pre{border-radius:.25rem;padding:1em;max-width:100%;overflow:auto}#md p code{font-size:.95rem;padding:.2em}#md code,#md pre{font-family:var(--font-mono);line-height:154%}#md pre{margin:1em 0}</style><link rel="preload" href="/assets/app.f386ae20.css" as="style"><link rel="modulepreload" crossorigin="" href="/assets/apocrypha-rs.2d37c5ad.js"><link rel="modulepreload" crossorigin="" href="/assets/TheArticle.8f9cde5d.js"><title>Rust 语言伪经 | Pak</title><meta name="description" content="某汉语 Rust 教程没能正确告诉你的内容。"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous"><meta name="head:count" content="2"></head><body><div id="app" data-server-rendered="true"><!--[--><header class="flex justify-between items-center my-4 gap-2" data-v-adef6890=""><nav class="inline-block px-2 py-1 rounded transition-lively" text="bgd" bg="acc hover:sec" font="mono bold" data-v-adef6890=""><a href="/" class="" data-v-adef6890="">pαk</a></nav><nav class="flex justify-between items-center gap-3" data-v-adef6890=""><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/archive" class="" data-v-adef6890=""><div i-mdi-text-box="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/posts" class="" data-v-adef6890=""><div i-mdi-file="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/sheets" class="" data-v-adef6890=""><div i-mdi-table-large="" data-v-adef6890=""></div></a></button><button transition-lively="" class="hover:text-sec" data-v-adef6890=""><a href="/notes" class="" data-v-adef6890=""><div i-mdi-folder="" data-v-adef6890=""></div></a></button></nav></header><main class="text-left"><main class="mb-8"><article class="text-left"><header class="flex flex-col justify-start items-start gap-2 mt-4 mb-8"><h1>Rust 语言伪经</h1><div class="flex flex-wrap gap-x-1 gap-y-0.5 justify-start items-center"><span class="flex justify-center"><button btn-icon=""><a href="/notes" class=""><div class="i-mdi-folder"></div></a></button></span><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively"><!--[--><time>2022/07/20</time><!--]--></span></span><span class="flex gap-1 justify-center items-center"><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-acc hover:bg-acc hover:text-bgd"><!--[--><a href="/categories/comp" class="">comp</a><!--]--></span></span><span class="flex gap-1 justify-center items-center"><!--[--><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-sec hover:bg-sec hover:text-bgd"><!--[--><a href="/tags?tag=pl" class=""> @pl</a><!--]--></span><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-sec hover:bg-sec hover:text-bgd"><!--[--><a href="/tags?tag=rust" class=""> @rust</a><!--]--></span><!--]--></span><span class="flex gap-1 justify-center items-center"><!--[--><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-dim"><!--[--><span> #rust</span><!--]--></span><span class="inline-block text-xs rounded p-1 font-mono font-bold transition-lively text-dim"><!--[--><span> #tutorial</span><!--]--></span><!--]--></span></div></header><nav m="t-4 b-8"><ul><!--[--><!--]--></ul></nav><article id="md"><div><p>某汉语 Rust 教程没能正确告诉你的内容。</p><!-- more --><p>从个人喜好来说，我<strong>不</strong>喜欢<a href="https://course.rs/" target="_blank" rel="noopener">某 Rust 中文教程</a>。不可否认的是，它诸如<a href="https://course.rs/index-list.html" target="_blank" rel="noopener">索引</a>的一些设计还是较为科学的，但我不太喜欢它的行文风格，过于泛滥的幽默之笔对于我来说似乎更容易发散掉注意力。我个人偏好官方出品的原版教材，<a href="https://doc.rust-lang.org/stable/book/" target="_blank" rel="noopener"><em>The Book</em></a>，它的行文比较紧凑且知识密集，当然可能略显枯燥。</p><p>客观来说，官方出品的教程在内容的准确性上更值得信赖。笔者本身对 Rust 的了解极其浅显，但对该中文教程中的一部分内容存有一些疑问。<strong>本篇的目标是，尽可能客观地考证并指出该中文教程中的偏误</strong>。</p><article note=""><h2 id="14-仅仅是-hello-world" tabindex="-1">1.4 - 仅仅是 Hello world</h2><p>在 <a href="https://course.rs/first-try/hello-world.html" target="_blank" rel="noopener">1.4 不仅是 Hello world</a> 一节，该教程给出了如下代码：</p><pre><code class="language-rust"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#282c34"><code><span class="line"><span style="color:#c678dd">fn</span><span style="color:#abb2bf"> </span><span style="color:#61afef">greet_world</span><span style="color:#abb2bf">() {</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd">let</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">southern_germany</span><span style="color:#abb2bf"> </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#98c379">"Grüß Gott!"</span><span style="color:#abb2bf">;</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd">let</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">chinese</span><span style="color:#abb2bf"> </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#98c379">"世界，你好"</span><span style="color:#abb2bf">;</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd">let</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">english</span><span style="color:#abb2bf"> </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> </span><span style="color:#98c379">"World, hello"</span><span style="color:#abb2bf">;</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd">let</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">regions</span><span style="color:#abb2bf"> </span><span style="color:#56b6c2">=</span><span style="color:#abb2bf"> [</span><span style="color:#e06c75">southern_germany</span><span style="color:#abb2bf">, </span><span style="color:#e06c75">chinese</span><span style="color:#abb2bf">, </span><span style="color:#e06c75">english</span><span style="color:#abb2bf">];</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#c678dd">for</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">region</span><span style="color:#abb2bf"> </span><span style="color:#c678dd">in</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">regions</span><span style="color:#abb2bf">.</span><span style="color:#61afef">iter</span><span style="color:#abb2bf">() {</span></span>
<span class="line"><span style="color:#abb2bf">            </span><span style="color:#61afef">println!</span><span style="color:#abb2bf">(</span><span style="color:#98c379">"{}"</span><span style="color:#abb2bf">, &amp;</span><span style="color:#e06c75">region</span><span style="color:#abb2bf">);</span></span>
<span class="line"><span style="color:#abb2bf">    }</span></span>
<span class="line"><span style="color:#abb2bf">}</span></span>
<span class="line"><span style="color:#c678dd">fn</span><span style="color:#abb2bf"> </span><span style="color:#61afef">main</span><span style="color:#abb2bf">() {</span></span>
<span class="line"><span style="color:#abb2bf">    </span><span style="color:#61afef">greet_world</span><span style="color:#abb2bf">();</span></span>
<span class="line"><span style="color:#abb2bf">}</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code><span class="line"><span style="color:#cf222e">fn</span><span style="color:#24292f"> </span><span style="color:#8250df">greet_world</span><span style="color:#24292f">() {</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#cf222e">let</span><span style="color:#24292f"> southern_germany </span><span style="color:#cf222e">=</span><span style="color:#24292f"> </span><span style="color:#0a3069">"Grüß Gott!"</span><span style="color:#24292f">;</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#cf222e">let</span><span style="color:#24292f"> chinese </span><span style="color:#cf222e">=</span><span style="color:#24292f"> </span><span style="color:#0a3069">"世界，你好"</span><span style="color:#24292f">;</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#cf222e">let</span><span style="color:#24292f"> english </span><span style="color:#cf222e">=</span><span style="color:#24292f"> </span><span style="color:#0a3069">"World, hello"</span><span style="color:#24292f">;</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#cf222e">let</span><span style="color:#24292f"> regions </span><span style="color:#cf222e">=</span><span style="color:#24292f"> [southern_germany, chinese, english];</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#cf222e">for</span><span style="color:#24292f"> region </span><span style="color:#cf222e">in</span><span style="color:#24292f"> regions</span><span style="color:#cf222e">.</span><span style="color:#8250df">iter</span><span style="color:#24292f">() {</span></span>
<span class="line"><span style="color:#24292f">            </span><span style="color:#8250df">println!</span><span style="color:#24292f">(</span><span style="color:#0a3069">"{}"</span><span style="color:#24292f">, </span><span style="color:#cf222e">&amp;</span><span style="color:#24292f">region);</span></span>
<span class="line"><span style="color:#24292f">    }</span></span>
<span class="line"><span style="color:#24292f">}</span></span>
<span class="line"><span style="color:#cf222e">fn</span><span style="color:#24292f"> </span><span style="color:#8250df">main</span><span style="color:#24292f">() {</span></span>
<span class="line"><span style="color:#24292f">    </span><span style="color:#8250df">greet_world</span><span style="color:#24292f">();</span></span>
<span class="line"><span style="color:#24292f">}</span></span>
<span class="line"></span></code></pre></div></code></pre><blockquote><p>对于 <code>println</code> 来说，我们没有使用其它语言惯用的 <code>%s</code>、<code>%d</code> 来做输出占位符，而是使用 <code>{}</code>，因为 Rust 在底层帮我们做了大量工作，会自动识别输出数据的类型，<s>例如当前例子，会识别为 <code>String</code> 类型</s>。（<a href="https://github.com/sunface/rust-course/blob/f0aebb43e37d64e7da1b58825e24e646fbccd0aa/src/first-try/hello-world.md?plain=1#L47" target="_blank" rel="noopener">原文</a>）</p></blockquote><p>Rust 一系列用于格式化的宏非常类似，<code>{}</code> 占位符只要求输出数据的类型实现了 <a href="https://doc.rust-lang.org/std/fmt/trait.Display.html" target="_blank" rel="noopener"><code>fmt::Display</code></a> 特征即可。而这里输出的的 <code>&amp;region</code> 是 <code>&amp;&amp;&amp;str</code> 类型，由于 <code>Display</code> 对于一切实现了它的类型的引用类型自动实现，且 <code>str</code> 实现了它，因此这个 <code>println</code> 可以正常工作。</p><p>考察 <code>println</code> 的底层实现，最终追溯到一个私有的模块 <code>io::stdio</code> 中的 <code>print_to</code> 泛型函数，它最终会向一个实现了 <code>io::Write</code> 的类型中写入，而 <code>println</code> 使用的是 <code>io::Stdout</code>。</p><p>无论是这里占位符处变量的类型，还是 <code>println</code> 的实现，都用不到<strong>堆上分配</strong>的 <code>String</code> 类型。</p><blockquote><p>最后，和其它语言不同，Rust 的集合类型不能直接进行循环，需要变成迭代器（这里是通过 .iter() 方法），才能用于迭代循环。[…]</p><p>实际上这段代码<s>可以简写</s>，在 2021 edition 及以后，支持直接写 for region in regions，原因会在迭代器章节的开头提到，是因为 for 隐式地将 regions 转换成迭代器。（<a href="https://github.com/sunface/rust-course/blob/f0aebb43e37d64e7da1b58825e24e646fbccd0aa/src/first-try/hello-world.md?plain=1#L49-L51" target="_blank" rel="noopener">原文</a>）</p></blockquote><p>Rust 的集合类型<strong>确实不能直接进行循环</strong>，但<a href="https://doc.rust-lang.org/std/primitive.array.html" target="_blank" rel="noopener">数组</a>（array）不算是 Rust 的集合类型，而是基本类型（primitive)，好比 C++ 的 <code>[]</code> 不是 <code>std::array</code>。但在语法上，集合类型当然可以出现在 <a href="https://doc.rust-lang.org/reference/expressions/loop-expr.html#iterator-loops" target="_blank" rel="noopener"><code>for</code> 循环</a>的表达式位置，只要这个类型实现了 <code>iter::IntoIterator</code> 即可。标准库 <code>collections</code> 实现的所有集合类型都实现了 <code>IntoIterator</code>，因此<em>从语法上来说</em> Rust 的集合类型是可以直接用 <code>for</code> 循环遍历的。当然，<code>for</code> 实际上是由 <code>IntoIterator::into_iter()</code>, <code>match</code> 和 <code>loop</code> 组成的复杂语法糖。</p><p>但数组的情况很特殊。在返回值的 <code>impl Trait</code> 以及常量泛型（const generics）稳定之前，<a href="https://github.com/rust-lang/rust/issues/25725#issuecomment-321489364" target="_blank" rel="noopener">这个 <code>impl IntoIterator</code> 并不方便实现</a>。数组本身可以<a href="https://doc.rust-lang.org/reference/type-coercions.html#unsized-coercions" target="_blank" rel="noopener">隐式类型转换为切片</a>，而切片的引用上实现 <code>IntoIterator</code> 不需要常量泛型，因此数组的引用之前可以使用 <code>for</code> 循环之。因此在数组的 <code>IntoIterator</code> 稳定后，由于 Rust 方法调用时会考虑隐式转换，在数组上显式调用<code>IntoIterator::into_iter</code> 在之前的版次中会导致隐式转换到切片，因此存在非向下兼容的冲突，最终<a href="https://doc.rust-lang.org/edition-guide/rust-2021/IntoIterator-for-arrays.html" target="_blank" rel="noopener">在 2021 版次才解决了这一问题</a>。而示例代码中的 <code>.iter()</code> 方法是切片的关联方法，实际上也引发了一次隐式转换。因此，所谓的“简写”实际上有细微的区别，甚至循环变量的类型也不相同。参考：</p><pre><code class="language-rust"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#282c34"><code><span class="line"><span style="color:#c678dd">for</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">i</span><span style="color:#abb2bf"> </span><span style="color:#c678dd">in</span><span style="color:#abb2bf">   [</span><span style="color:#d19a66">1</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">2</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">3</span><span style="color:#abb2bf">] .</span><span style="color:#61afef">iter</span><span style="color:#abb2bf">() { </span><span style="color:#7f848e;font-style:italic">/* i: &amp;i32; */</span><span style="color:#abb2bf"> }</span><span style="color:#7f848e;font-style:italic"> // 1 </span></span>
<span class="line"><span style="color:#c678dd">for</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">i</span><span style="color:#abb2bf"> </span><span style="color:#c678dd">in</span><span style="color:#abb2bf">   [</span><span style="color:#d19a66">1</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">2</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">3</span><span style="color:#abb2bf">]         { </span><span style="color:#7f848e;font-style:italic">/* i:  i32; */</span><span style="color:#abb2bf"> }</span><span style="color:#7f848e;font-style:italic"> // 2</span></span>
<span class="line"><span style="color:#c678dd">for</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">i</span><span style="color:#abb2bf"> </span><span style="color:#c678dd">in</span><span style="color:#abb2bf"> (&amp;[</span><span style="color:#d19a66">1</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">2</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">3</span><span style="color:#abb2bf">]).</span><span style="color:#61afef">iter</span><span style="color:#abb2bf">() { </span><span style="color:#7f848e;font-style:italic">/* i: &amp;i32; */</span><span style="color:#abb2bf"> }</span><span style="color:#7f848e;font-style:italic"> // 3</span></span>
<span class="line"><span style="color:#c678dd">for</span><span style="color:#abb2bf"> </span><span style="color:#e06c75">i</span><span style="color:#abb2bf"> </span><span style="color:#c678dd">in</span><span style="color:#abb2bf">  &amp;[</span><span style="color:#d19a66">1</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">2</span><span style="color:#abb2bf">, </span><span style="color:#d19a66">3</span><span style="color:#abb2bf">]         { </span><span style="color:#7f848e;font-style:italic">/* i: &amp;i32; */</span><span style="color:#abb2bf"> }</span><span style="color:#7f848e;font-style:italic"> // 4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// ~&gt;  coercion</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// =&gt;  call</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// -&gt;  type</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">//</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// 1:  [i32; 3] ~&gt; [i32] =&gt; .iter() -&gt; slice::Iter[i32] =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// 2:  [i32; 3]                                         =&gt; .into_iter() -&gt; array::IntoIter&lt;i32, 3&gt;</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// 3: &amp;[i32; 3] ~&gt; [i32] =&gt; .iter() -&gt; slice::Iter[i32] =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"><span style="color:#7f848e;font-style:italic">// 4: &amp;[i32; 3]                                         =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code><span class="line"><span style="color:#cf222e">for</span><span style="color:#24292f"> i </span><span style="color:#cf222e">in</span><span style="color:#24292f">   [</span><span style="color:#0550ae">1</span><span style="color:#24292f">, </span><span style="color:#0550ae">2</span><span style="color:#24292f">, </span><span style="color:#0550ae">3</span><span style="color:#24292f">] </span><span style="color:#cf222e">.</span><span style="color:#8250df">iter</span><span style="color:#24292f">() { </span><span style="color:#6e7781">/* i: &amp;i32; */</span><span style="color:#24292f"> }</span><span style="color:#6e7781"> // 1 </span></span>
<span class="line"><span style="color:#cf222e">for</span><span style="color:#24292f"> i </span><span style="color:#cf222e">in</span><span style="color:#24292f">   [</span><span style="color:#0550ae">1</span><span style="color:#24292f">, </span><span style="color:#0550ae">2</span><span style="color:#24292f">, </span><span style="color:#0550ae">3</span><span style="color:#24292f">]         { </span><span style="color:#6e7781">/* i:  i32; */</span><span style="color:#24292f"> }</span><span style="color:#6e7781"> // 2</span></span>
<span class="line"><span style="color:#cf222e">for</span><span style="color:#24292f"> i </span><span style="color:#cf222e">in</span><span style="color:#24292f"> (</span><span style="color:#cf222e">&amp;</span><span style="color:#24292f">[</span><span style="color:#0550ae">1</span><span style="color:#24292f">, </span><span style="color:#0550ae">2</span><span style="color:#24292f">, </span><span style="color:#0550ae">3</span><span style="color:#24292f">])</span><span style="color:#cf222e">.</span><span style="color:#8250df">iter</span><span style="color:#24292f">() { </span><span style="color:#6e7781">/* i: &amp;i32; */</span><span style="color:#24292f"> }</span><span style="color:#6e7781"> // 3</span></span>
<span class="line"><span style="color:#cf222e">for</span><span style="color:#24292f"> i </span><span style="color:#cf222e">in</span><span style="color:#24292f">  </span><span style="color:#cf222e">&amp;</span><span style="color:#24292f">[</span><span style="color:#0550ae">1</span><span style="color:#24292f">, </span><span style="color:#0550ae">2</span><span style="color:#24292f">, </span><span style="color:#0550ae">3</span><span style="color:#24292f">]         { </span><span style="color:#6e7781">/* i: &amp;i32; */</span><span style="color:#24292f"> }</span><span style="color:#6e7781"> // 4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6e7781">// ~&gt;  coercion</span></span>
<span class="line"><span style="color:#6e7781">// =&gt;  call</span></span>
<span class="line"><span style="color:#6e7781">// -&gt;  type</span></span>
<span class="line"><span style="color:#6e7781">//</span></span>
<span class="line"><span style="color:#6e7781">// 1:  [i32; 3] ~&gt; [i32] =&gt; .iter() -&gt; slice::Iter[i32] =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"><span style="color:#6e7781">// 2:  [i32; 3]                                         =&gt; .into_iter() -&gt; array::IntoIter&lt;i32, 3&gt;</span></span>
<span class="line"><span style="color:#6e7781">// 3: &amp;[i32; 3] ~&gt; [i32] =&gt; .iter() -&gt; slice::Iter[i32] =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"><span style="color:#6e7781">// 4: &amp;[i32; 3]                                         =&gt; .into_iter() -&gt; slice::Iter[i32]</span></span>
<span class="line"></span></code></pre></div></code></pre></article></div></article></article></main></main><!----><!--]--></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><script>!function(){var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("color-scheme")||"auto",t=(document.documentElement.className="dark"===a||t&&"light"!==a?"dark":"",localStorage.getItem("typesetting::accent_color"));if(t){a=JSON.parse(t),t=Object.entries(a).map(e=>`--accent-${e[0]}: ${e[1]};`).join("\n");let e=document.createElement("style");e.type="text/css",e.innerText=`:root{${t}}`,document.head.appendChild(e)}}()</script><link rel="stylesheet" href="/assets/app.f386ae20.css"></body></html>