import{_ as t}from"./TheArticle.414e061d.js";import{o as p,f as l}from"./app.079c9e99.js";const r="KMP \u7B97\u6CD5",h="2020-06-11T13:39:02.000Z",g="comp",y=["dsa"],d=["string"],x=!0,w={setup(m,{expose:a}){const s={title:"KMP \u7B97\u6CD5",date:"2020-06-11T13:39:02.000Z",category:"comp",tags:["dsa"],keywords:["string"],math:!0};return a({frontmatter:s}),(e,i)=>{const n=t;return p(),l(n,{frontmatter:s,inner:`<div><p>KMP \u7B97\u6CD5\u662F\u5229\u7528\u91CD\u590D\u7247\u6BB5\u8FDB\u884C\u4F18\u5316\u7684\uFF0C\u65E0\u56DE\u6EAF\u7684\u5B57\u7B26\u4E32\u5339\u914D\u7B97\u6CD5\u3002</p>
<!-- more -->
<p><strong>\u66F4\u65B0</strong>\uFF082021-10-14\uFF09\uFF1A\u4FEE\u6B63\u4E86\u9884\u5904\u7406\u8BA1\u7B97 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> \u65F6\u672A\u8FDB\u884C\u9012\u63A8\u5904\u7406\u7684\u9519\u8BEF\u3002</p>
<h2 id="\u56DE\u6EAF" tabindex="-1">\u56DE\u6EAF</h2>
<blockquote>
<p>TL;DR | \u66B4\u529B\u7B97\u6CD5\u4E2D\u5B58\u5728\u4E0D\u5FC5\u8981\u7684<strong>\u5411\u5DE6\u56DE\u9000</strong>\u6BD4\u8F83\u3002</p>
</blockquote>
<p><strong>\u66B4\u529B</strong>\u7684\u5B57\u7B26\u4E32\u5339\u914D\u7B97\u6CD5\u4F1A\u9047\u5230\u56DE\u6EAF\u7684\u60C5\u51B5\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abc

    ababc
  1|^
  2|a^
! 3|ab^
! 4| ^
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abc

    ababc
  1|^
  2|a^
! 3|ab^
! 4| ^
</span></span></code></pre></div></code></pre>
<p>\u7528<strong>\u6A21\u5F0F\u4E32</strong>abc \u5339\u914D<strong>\u76EE\u6807\u4E32</strong>ababc\uFF0C\u5728\u7B2C 3 \u6B65\u4E2D\uFF0C\u5148\u5C06\u6A21\u5F0F\u4E32\u7B2C 0 \u4F4D\u5BF9\u9F50\u76EE\u6807\u4E32\u7B2C 0 \u4F4D\uFF0C\u6A21\u5F0F\u4E32\u7684\u524D\u4E24\u4F4D\u5339\u914D\u6210\u529F\uFF0C\u7B2C 2 \u4F4D\u5339\u914D\u5931\u8D25(3)\uFF0C\u56E0\u6B64\u5C06\u6A21\u5F0F\u4E32\u7684\u7B2C\u96F6\u4F4D\u79FB\u52A8\u5230\u76EE\u6807\u4E32\u7B2C 1 \u4F4D\u91CD\u65B0\u5BF9\u9F50(4)\uFF0C\u56E0\u800C\u6BD4\u8F83\u7684\u4F4D\u7F6E<strong>\u56DE\u6EAF</strong>\u4E86\uFF0C\u4F46\u7531\u4E8E(2)\u7528\u6A21\u5F0F\u4E32\u7B2C 1 \u4F4D b \u5339\u914D\u76EE\u6807\u4E32\u7B2C 1 \u4F4D b \u6210\u529F\uFF0C(4)\u7528\u6A21\u5F0F\u4E32\u7B2C 0 \u4F4D a \u91CD\u65B0\u5339\u914D\u76EE\u6807\u4E32\u7B2C 1 \u4F4D\u5FC5\u5B9A\u5931\u8D25\uFF0C\u56E0\u6B64\u8FD9\u6837\u7684\u56DE\u6EAF\u662F\u59A8\u5BB3\u6548\u7387\u7684\u3002\u4E3B\u8981\u539F\u56E0\u662F\uFF0C\u5728\u56DE\u6EAF\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u539F\u6709\u7684\u5339\u914D\u6210\u529F\u4FE1\u606F\u6CA1\u6709\u88AB\u5229\u7528\u5373\u88AB\u4E22\u5F03\u3002</p>
<p>\u8BBE\u6A21\u5F0F\u4E32\u957F\u5EA6\u4E3A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>\uFF0C\u76EE\u6807\u4E32\u957F\u5EA6\u4E3A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>\uFF0C\u6700\u574F\u60C5\u51B5\u662F\u6BCF\u6B21\u90FD\u5728\u6A21\u5F0F\u4E32\u7684\u6700\u540E\u4E00\u4F4D\u5339\u914D\u5931\u8D25\uFF0C\u5373\u5339\u914D<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>\u6B21\u540E\u5931\u8D25\uFF0C\u4E00\u76F4\u6BD4\u8F83\u5230\u6A21\u5F0F\u4E32\u548C\u76EE\u6807\u4E32\u53F3\u5BF9\u9F50\uFF0C\u6A21\u5F0F\u4E32\u7684\u7B2C\u96F6\u4F4D\u5BF9\u9F50\u5728\u76EE\u6807\u4E32\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>\u2212</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n-m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">\u2212</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>\u4F4D\uFF0C\u4E00\u5171\u6BD4\u8F83<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>\u2212</mo><mi>m</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-m+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">\u2212</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>\u6B21\u3002\u7531\u4E8E<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>\u2265</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \\ge m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">\u2265</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>\uFF0C\u56E0\u800C\u6700\u574F\u65F6\u95F4\u590D\u6742\u5EA6\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(mn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\u3002</p>
<h2 id="kmp-\u7B97\u6CD5" tabindex="-1">KMP \u7B97\u6CD5</h2>
<blockquote>
<p>TL;DR | KMP \u7B97\u6CD5\u5229\u7528\u4E86\u6A21\u5F0F\u4E32\u4E2D<strong>\u91CD\u590D</strong>\u7684\u7247\u6BB5\uFF0C\u901A\u8FC7<strong>\u5BF9\u9F50</strong>\u8FD9\u4E9B\u7247\u6BB5\u5B9E\u73B0\u4E0D\u5411\u5DE6\u540E\u9000\u3002</p>
</blockquote>
<p>\u66B4\u529B\u7B97\u6CD5\u4E2D\uFF0C\u6BCF\u6B21\u5728\u6A21\u5F0F\u4E32\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u4F4D\u548C\u76EE\u6807\u4E32\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>\u4F4D\u5339\u914D\u5931\u8D25\u4EE5\u540E\uFF0C\u6A21\u5F0F\u4E32\u5DE6\u7AEF\u603B\u662F\u5411\u53F3\u79FB\u52A8 1 \u4F4D\u3002\u800C****KMP \u7B97\u6CD5****\u7684\u601D\u8DEF\u662F\uFF0C\u6839\u636E\u6A21\u5F0F\u4E32\u7684\u67D0\u79CD\u89C4\u5F8B\uFF08\u5C06\u5728\u4E0B\u6587\u5206\u6790\uFF09\uFF0C\u5F97\u51FA\u4E00\u4E2A\u5BF9\u5E94\u5173\u7CFB<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">next</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span></span></span></span>\uFF0C\u4F7F\u5F97\u5728\u6A21\u5F0F\u4E32\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u4F4D\u548C\u76EE\u6807\u4E32\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>\u4F4D\u5339\u914D\u5931\u8D25\u4EE5\u540E\uFF0C\u4F7F\u5F97\u6A21\u5F0F\u4E32\u7684<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>\u4F4D\u548C\u76EE\u6807\u4E32<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>\u4F4D\u5BF9\u9F50\uFF0C\u5373\u6A21\u5F0F\u4E32\u5DE6\u7AEF\u5411\u53F3\u79FB\u52A8<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>\u2212</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">i-next(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">\u2212</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>\u4F4D\uFF0C<strong>\u907F\u514D\u53D1\u751F\u56DE\u6EAF</strong>\u3002\u5206\u6790\u4EE5\u4E0B\u64CD\u4F5C\u7684\u4F8B\u5B50\uFF1A</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abcdabd

    0   45
    abcdaabcda
! 1|abcda^
  2|    a^
    *   *

    01  456
    abcdabcdabd
! 3|abcdab^
  4|    ab^
    **  **
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abcdabd

    0   45
    abcdaabcda
! 1|abcda^
  2|    a^
    *   *

    01  456
    abcdabcdabd
! 3|abcdab^
  4|    ab^
    **  **
</span></span></code></pre></div></code></pre>
<p>\u5148\u770B<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">\u2260</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i\\ne0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">\uE020</span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>\u65F6\u7684\u60C5\u51B5\u3002</p>
<p>\u5BF9\u4E8E\u6A21\u5F0F\u4E32<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>\u5339\u914D\u5931\u8D25\u7684\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u4F4D<strong>\u4E4B\u524D\u7684</strong>\u90E8\u5206\uFF0C\u5373\u5B50\u4E32<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">\u2032</mo></msubsup><mo>=</mo><msub><mi>p</mi><mn>0</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>\u2026</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p&#x27;_{i}=p_0 p_1 \\dots p_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">\u2032</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">\u2026</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">\u2212</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>\uFF0C\u6211\u4EEC\u5E0C\u671B\u627E\u5230<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>p</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">\u2032</mo></msubsup></mrow><annotation encoding="application/x-tex">p&#x27;_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">\u2032</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span>\u4E2D<strong>\u6700\u957F</strong>\u7684\u4E00\u5BF9<strong>\u5B8C\u5168\u76F8\u540C</strong>\u7684<strong>\u524D\u7F00\u548C\u540E\u7F00</strong>\uFF0C\u5E76\u628A\u5B83\u7684\u957F\u5EA6\u8BB0\u4F5C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>\uFF0C\u5373\uFF1A</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><msub><mi>p</mi><mn>1</mn></msub><mo>\u2026</mo><msub><mi>p</mi><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>\u2212</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2212</mo><msub><mi>k</mi><mi>i</mi></msub></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2212</mo><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></msub><mo>\u2026</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_0 p_1 \\dots p_{k_i-1} = p_{i-k_i} p_{i-k_i+1} \\dots p_{i-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">\u2026</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">\u2212</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">\u2212</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">\u2212</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">\u2026</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">\u2212</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>\u5E76\u901A\u8FC7\u79FB\u4F4D\u4F7F\u5F97<strong>\u524D\u7F00\u5DE6\u7AEF</strong>\u79FB\u5230\u539F\u6765<strong>\u540E\u7F00\u5DE6\u7AEF</strong>\u5BF9\u5E94\u7684\u4F4D\u7F6E\uFF0C\u53EF\u4EE5\u5F97\u5230\uFF1A</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>k</mi><mi>i</mi></msub></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">next(i) = k_i\\tag{1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></p>
<p>\u5982\u679C\u627E\u4E0D\u5230\u7B26\u5408\u4E0A\u8FF0\u8981\u6C42\u7684\u4E00\u5BF9\u524D\u7F00\u548C\u540E\u7F00\u65F6\uFF0C\u5C06\u6A21\u5F0F\u4E32\u7684\u5DE6\u7AEF\u76F4\u63A5\u5BF9\u9F50\u5230\u5339\u914D\u5931\u8D25\u7684\u4E00\u4F4D\u5373\u53EF\u3002\u6B64\u65F6<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>\uFF0C\u516C\u5F0F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>\u4ECD\u7136\u6210\u7ACB\u3002</p>
<p>\u5982\u679C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>\uFF0C\u4E5F\u5C31\u662F\u7B2C 0 \u4F4D\u5DF2\u7ECF\u5339\u914D\u5931\u8D25\uFF0C\u5219\u6A21\u5F0F\u4E32\u7684\u5DE6\u7AEF\u79FB\u5230<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>\uFF0C\u7EE7\u7EED\u6BD4\u8F83\u3002\u4EE4<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mo>\u2212</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k_0=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">\u2212</span><span class="mord">1</span></span></span></span>\uFF0C\u516C\u5F0F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>\u4ECD\u7136\u6210\u7ACB\uFF0C\u53EA\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mo>\u2212</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">p_{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">\u2212</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>\u6CA1\u6709\u610F\u4E49\u3002\u8BFE\u672C\u4E0A\u57FA\u4E8E\u6B64\u70B9\u628A\u8FD9\u4E24\u4E2A\u6DF7\u5728\u4E00\u8D77\u4E86\uFF0C\u591A\u5FAA\u73AF\u4E86\u4E00\u6B21\uFF0C\u4E2A\u4EBA\u89C9\u5F97\u6709\u70B9\u8FD8\u662F\u5206\u5F00\u5904\u7406\u6BD4\u8F83\u597D\u7406\u89E3\u3002</p>
<p>\u5728<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">j &lt; n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>\u65F6\u5982\u679C\u627E\u5230\u76EE\u6807\u4E32\u4E2D\u5339\u914D\u6A21\u5F0F\u4E32\u7684\u5B50\u4E32\uFF0C\u5373\u6EE1\u8DB3<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>m</mi><mo>\u2212</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=m-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">\u2212</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>\u65F6\u5339\u914D\uFF0C\u5219\u8FD4\u56DE\u6A21\u5F0F\u4E32\u5DE6\u7AEF\u4F4D\u7F6E<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>\u2212</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j-i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">\u2212</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u3002\u5982\u679C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">j=n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>\uFF0C\u8BF4\u660E\u76EE\u6807\u4E32\u4E2D\u4E0D\u5B58\u5728\u5339\u914D\u6A21\u5F0F\u4E32\u7684\u5B57\u4E32\uFF0C\u8FD4\u56DE\u8868\u793A\u641C\u7D22\u65E0\u7ED3\u679C\u7684\u503C\u3002</p>
<p>\u5728\u641C\u7D22\u8FC7\u7A0B\u4E2D\uFF0C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>\u4E0D\u4F1A\u51CF\u5C0F\uFF08\u5373\u4E0D\u4F1A\u53D1\u751F\u56DE\u6EAF\uFF09\uFF0C\u9012\u589E\u7684\u6B21\u6570\u4E0D\u4F1A\u8D85\u8FC7<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>\u3002<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>\u9012\u589E\u7684\u540C\u65F6\uFF0C\u4E00\u5B9A\u4F34\u968F\u7740<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u9012\u589E\uFF0C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u5728\u5339\u914D\u5931\u8D25\u65F6\u4E5F\u4F1A\u51CF\u5C0F\uFF0C\u4F46\u6700\u591A\u51CF\u5C0F\u5230 0\uFF0C\u51CF\u5C0F\u7684\u6B21\u6570\u4E0D\u4F1A\u591A\u4E8E\u589E\u52A0\u7684\u6B21\u6570\uFF0C\u56E0\u6B64\u6700\u7EC8<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u9012\u589E\u7684\u6B21\u6570\u4E0D\u4F1A\u8D85\u8FC7<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span></span></span></span>\u3002\u6240\u4EE5\uFF0C\u641C\u7D22\u90E8\u5206\u7684\u6700\u574F\u65F6\u95F4\u590D\u6742\u5EA6\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\u3002</p>
<h2 id="\u6A21\u5F0F\u4E32\u7684\u9884\u5904\u7406" tabindex="-1">\u6A21\u5F0F\u4E32\u7684\u9884\u5904\u7406</h2>
<blockquote>
<p>TL;DR | \u901A\u8FC7\u9012\u63A8\u7684\u65B9\u6CD5\u53EF\u4EE5\u5FEB\u901F\u63A8\u51FA<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>\u8868\uFF0C\u8FD8\u53EF\u4EE5\u518D\u8FDB\u884C\u9012\u5F52\u4F18\u5316\u907F\u514D\u5728\u79FB\u52A8\u6A21\u5F0F\u4E32\u524D\u540E\u6BD4\u8F83\u5185\u5BB9\u76F8\u540C\u7684\u60C5\u51B5\u3002</p>
</blockquote>
<p>\u95EE\u9898\u7684\u5173\u952E\u8F6C\u79FB\u5230\u4E86\u8BA1\u7B97<strong>\u6700\u957F\u76F8\u540C\u524D\u540E\u7F00\u957F\u5EA6</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>\u3002\u8FD9\u91CC\u5229\u7528\u9012\u63A8\u4F1A\u6BD4\u8F83\u7B80\u5355\u3002</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abaaa

    0  1  2  3  4
    a  b  a  a  a
0| -1  0  0

 |  *     ^
1| -1  0  0-&gt;1

 |  *  *  ^  ^
2| -1  0  0  1-&gt;2

...
 |  *  *  !
 |        ^  ^  !
3| -1  0  0  1  2-&gt;0
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abaaa

    0  1  2  3  4
    a  b  a  a  a
0| -1  0  0

 |  *     ^
1| -1  0  0-&gt;1

 |  *  *  ^  ^
2| -1  0  0  1-&gt;2

...
 |  *  *  !
 |        ^  ^  !
3| -1  0  0  1  2-&gt;0
</span></span></code></pre></div></code></pre>
<p>\u521D\u59CB\u6761\u4EF6(0)\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mo>\u2212</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k_0=-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">\u2212</span><span class="mord">1</span></span></span></span>\u3002</p>
<p>\u9012\u63A8\u65F6\uFF0C\u9996\u5148\u9A8C\u8BC1<strong>\u4E0A\u4E00\u6B21\u9A8C\u8BC1</strong>\u4E2D\u524D\u7F00\u672B\u5C3E\u7684\u4E0B\u4E00\u4F4D\uFF08\u628A\u8FD9\u4E2A\u4F4D\u7F6E\u8BB0\u4F5C <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>\uFF09\u548C\u540E\u7F00\u672B\u5C3E\u7684\u4E0B\u4E00\u4F4D\u662F\u5426\u76F8\u7B49\uFF0C\u5982\u679C\u76F8\u7B49\uFF08\u89C1\u4E0A\u56FE\uFF09\uFF0C\u8BF4\u660E <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>\u2212</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k_i = k_{i-1}+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">\u2212</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>\u3002\u5982\u679C\u4E0D\u76F8\u7B49\uFF0C\u76F8\u5F53\u4E8E\u5728\u524D\u7F00\u672B\u5C3E\u7684\u4E0B\u4E00\u4F4D\uFF08<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>\uFF09\u5904<strong>\u5931\u914D</strong>\uFF0C\u56E0\u6B64\u5E94\u79FB\u52A8\u5230 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> \u5904\uFF08\u89C1\u4E0B\u56FE\u7684\u767E\u5206\u53F7\u5904\uFF0C\u4E5F\u5C31\u662F <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> \u53D8\u4E3A\u4E86\u65B0\u7684\u524D\u7F00\u672B\u5C3E\uFF09\u7EE7\u7EED\u5C1D\u8BD5\u5339\u914D\uFF0C\u76F4\u81F3\u5339\u914D\u6210\u529F\uFF0C\u6216 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> \u8FED\u4EE3\u4E3A\u8D1F\u6570\u3002</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abaab

    0  1  2  3  4
    a  b  a  a  b
0| -1  0  0  1
 
 |  *  !  ^  !
1| -1  0  0  1-&gt;?
 |     %

 |  *        ^
2| -1  0  0  1-&gt;1
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abaab

    0  1  2  3  4
    a  b  a  a  b
0| -1  0  0  1
 
 |  *  !  ^  !
1| -1  0  0  1-&gt;?
 |     %

 |  *        ^
2| -1  0  0  1-&gt;1
</span></span></code></pre></div></code></pre>
<p>\u8FD9\u6837\u5C31\u5F97\u5230\u4E86<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">next</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span></span></span></span>\uFF0C\u4F46\u662F\u8FD8\u6709\u4F18\u5316\u7684\u7A7A\u95F4\u3002</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abab
   a  b  a  b
k -1  0  0  1

    abaabab
! 1|aba^
! 2|  a^
  3|   ^
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abab
   a  b  a  b
k -1  0  0  1

    abaabab
! 1|aba^
! 2|  a^
  3|   ^
</span></span></code></pre></div></code></pre>
<p>\u5728\u8FD9\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u53D1\u73B0(1)\u5339\u914D\u5931\u8D25\uFF0C(2)\u5FC5\u5B9A\u4E5F\u5339\u914D\u5931\u8D25\uFF0C\u4E24\u6B21\u6BD4\u8F83\u7684\u5B57\u7B26\u5B8C\u5168\u76F8\u540C\uFF0C\u591A\u4E86\u4E00\u6B21\u65E0\u8C13\u7684\u6BD4\u8F83\uFF0C\u6839\u672C\u539F\u56E0\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo mathvariant="normal">\u2260</mo><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><msub><mi>p</mi><msub><mi>k</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">s_j \\ne p_{i}=p_{k_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">\uE020</span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>\uFF0C\u4F7F\u5F97\u79FB\u52A8\u6A21\u5F0F\u4E32\u540E\uFF0C\u6BD4\u8F83\u7684\u5B57\u7B26\u6CA1\u6709\u53D8\uFF0C\u8FD8\u9700\u8981\u518D\u6B21\u79FB\u52A8\u3002\u56E0\u6B64\uFF0C\u53EF\u4EE5\u5BF9<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>\uFF08\u5F53\u7136\u4E5F\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>\uFF09<strong>\u9012\u63A8\u5730\u4F18\u5316</strong>\uFF1A\u5F53<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><msub><mi>p</mi><msub><mi>k</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">p_i = p_{k_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>\u65F6\uFF0C\u4EE4<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><msub><mi>k</mi><msub><mi>k</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">k_i = k_{k_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9445399999999999em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">\u200B</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span> \uFF0C\u6216\u8005\u5199\u4F5C\u201C\u4EE4<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(i) = next(next(i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>\u201D\uFF0C\u53EF\u80FD\u66F4\u65B9\u4FBF\u7406\u89E3\u3002</p>
<p>\u5BF9\u4E8E\u4E0A\u4F8B\uFF0C\u4F18\u5316\u6548\u679C\u5982\u4E0B\u6240\u793A\uFF1A</p>
<pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #abb2bf">\u6A21\u5F0F\u4E32 abab
    a  b  a  b
k  -1  0  0  1
k&#39; -1  0 -1  0

    abaabab
! 1|aba^
  2|   ^
</span></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #24292f">\u6A21\u5F0F\u4E32 abab
    a  b  a  b
k  -1  0  0  1
k&#39; -1  0 -1  0

    abaabab
! 1|aba^
  2|   ^
</span></span></code></pre></div></code></pre>
<p>\u9884\u5904\u7406\u8FC7\u7A0B\u4E2D\uFF0C\u5BF9\u4E8E\u9012\u63A8\u90E8\u5206\u7684\u65F6\u95F4\u590D\u6742\u5EA6\uFF0C\u5916\u5C42\u5FAA\u73AF\u4E2D <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> \u9012\u589E\uFF0C\u5185\u5C42\u5FAA\u73AF\u4E2D <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> \u9012\u51CF\uFF08\u6052\u6709 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">next(k) &lt; k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>\uFF09\uFF0C\u7531 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>\u2265</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k\\ge0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">\u2265</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> \u4E14\u5176\u521D\u503C\u4E3A <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> \u77E5\u9012\u51CF\u603B\u6B21\u6570\u4E00\u5B9A\u5C0F\u4E8E\u7B49\u4E8E\u9012\u589E\u603B\u6B21\u6570 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>\uFF1B\u800C\u4F18\u5316\u4E2D\uFF0C\u7531\u4E8E\u4F18\u5316\u5230\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>\u9879\u65F6\u7B2C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">next(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>\u9879\u5DF2\u7ECF\u4F18\u5316\u8FC7\uFF0C\u56E0\u6B64\u65E0\u9700\u9012\u63A8\u3002\u56E0\u6B64\uFF0C\u9884\u5904\u7406\u8FC7\u7A0B\u7684\u65F6\u95F4\u590D\u6742\u5EA6\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>\u3002</p>
<h2 id="\u7ED3\u8BBA" tabindex="-1">\u7ED3\u8BBA</h2>
<blockquote>
<p>TL;DR | KMP \u7B97\u6CD5\u65F6\u95F4\u590D\u6742\u5EA6\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m+n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\u3002</p>
</blockquote>
<p>\u7EFC\u4E0A\uFF0CKMP \u7B97\u6CD5\u7684\u65F6\u95F4\u590D\u6742\u5EA6\u662F<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m+n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\uFF0C\u5C0F\u4E8E\u66B4\u529B\u7B97\u6CD5\u7684<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(mn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\u3002\u7531\u4E8E\u5728\u5B9E\u8DF5\u4E2D\u901A\u5E38<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>\u226A</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \\ll n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">\u226A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>\uFF0C\u56E0\u6B64 KMP \u7B97\u6CD5\u7684\u65F6\u95F4\u590D\u6742\u5EA6\u53EF\u4EE5\u89C6\u4E3A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\u3002\u4F46\u662F\uFF0C\u7531\u4E8E KMP \u7B97\u6CD5\u7684\u4F18\u5316\u57FA\u4E8E\u91CD\u590D\u7247\u6BB5\uFF0C\u56E0\u6B64\u4F7F\u7528\u7684\u5B57\u7B26\u96C6\u6BD4\u8F83\u5927\u65F6\uFF08\u6BD4\u5982\u6C49\u8BED\u7684\u5B57\u7B26\u96C6\uFF09\uFF0C\u91CD\u590D\u7247\u6BB5\u51FA\u73B0\u7684\u6982\u7387\u4F4E\uFF0C\u5B83\u7684\u6548\u7387\u63D0\u5347\u4E5F\u6709\u9650\u3002\u5B9E\u8DF5\u4E2D\uFF0C\u4ECE\u5C3E\u90E8\u5F00\u59CB\u5411\u5DE6\u5339\u914D\u5E76\u8BA1\u7B97\u201C\u574F\u5B57\u7B26\u201D\u7684\u53E6\u4E00\u4E2A\u5B57\u7B26\u4E32\u5339\u914D\u7B97\u6CD5\uFF0CBM \u7B97\u6CD5\uFF0C\u6548\u7387\u66F4\u9AD8\uFF0C\u53EF\u4EE5\u8FBE\u5230<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>\uFF0C\u53EF\u4EE5\u67E5\u770B\u53C2\u8003\u8D44\u6599\u4E2D\u7684\u6587\u7AE0\u4E2D\u7684\u4ECB\u7ECD\u3002</p>
<h2 id="python-\u5B9E\u73B0" tabindex="-1">Python \u5B9E\u73B0</h2>
<pre><code class="language-python"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color: #282c34"><code><span class="line"><span style="color: #D19A66">NO_MATCH</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">kmp</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66; font-style: italic">p</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">s</span><span style="color: #ABB2BF">): </span><span style="color: #7F848E; font-style: italic"># pattern \u6A21\u5F0F\u4E32, string \u76EE\u6807\u4E32</span></span>
<span class="line"><span style="color: #ABB2BF">    m, n </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">len</span><span style="color: #ABB2BF">(p), </span><span style="color: #56B6C2">len</span><span style="color: #ABB2BF">(s)</span></span>
<span class="line"><span style="color: #ABB2BF">    i, j </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">0</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic"># \u9884\u5904\u7406</span></span>
<span class="line"><span style="color: #ABB2BF">    nxt </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> [</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">] </span><span style="color: #7F848E; font-style: italic"># next \u9884\u5904\u7406\u8868</span></span>
<span class="line"><span style="color: #ABB2BF">    k </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic"># \u4E0A\u4E00\u6B21\u9A8C\u8BC1\u7684\u524D\u7F00\u672B\u5C3E</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">for</span><span style="color: #ABB2BF"> x </span><span style="color: #C678DD; font-style: italic">in</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">range</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, m):</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">while</span><span style="color: #ABB2BF"> k </span><span style="color: #56B6C2">&gt;=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">and</span><span style="color: #ABB2BF"> p[x</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">] </span><span style="color: #56B6C2">!=</span><span style="color: #ABB2BF"> p[k]:</span></span>
<span class="line"><span style="color: #ABB2BF">            k </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> nxt[k] </span><span style="color: #7F848E; font-style: italic"># \u5728 k \u5904\u5931\u914D</span></span>
<span class="line"><span style="color: #ABB2BF">        k </span><span style="color: #56B6C2">+=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic"># k \u5904\u5339\u914D\u6210\u529F\uFF0C\u524D\u7F00\u957F\u5EA6\u53EF\u4EE5\u9012\u589E 1</span></span>
<span class="line"><span style="color: #ABB2BF">        </span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> p[k] </span><span style="color: #56B6C2">==</span><span style="color: #ABB2BF"> p[x]:</span></span>
<span class="line"><span style="color: #ABB2BF">            nxt.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(nxt[k]) </span><span style="color: #7F848E; font-style: italic"># \u4F18\u5316</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">else</span><span style="color: #ABB2BF">: nxt.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(k)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #7F848E; font-style: italic"># \u6BD4\u8F83</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">while</span><span style="color: #ABB2BF"> i </span><span style="color: #56B6C2">&lt;</span><span style="color: #ABB2BF"> m </span><span style="color: #C678DD">and</span><span style="color: #ABB2BF"> j </span><span style="color: #56B6C2">&lt;</span><span style="color: #ABB2BF"> n:</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> p[i] </span><span style="color: #56B6C2">==</span><span style="color: #ABB2BF"> s[j]: </span><span style="color: #7F848E; font-style: italic"># \u5339\u914D\u6210\u529F</span></span>
<span class="line"><span style="color: #ABB2BF">            i </span><span style="color: #56B6C2">+=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">; j </span><span style="color: #56B6C2">+=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">else</span><span style="color: #ABB2BF">: </span><span style="color: #7F848E; font-style: italic"># \u5339\u914D\u5931\u8D25</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> nxt[i] </span><span style="color: #56B6C2">==</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">: </span><span style="color: #7F848E; font-style: italic"># \u5411\u540E\u79FB\u52A81\u4F4D</span></span>
<span class="line"><span style="color: #ABB2BF">                i </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">; j </span><span style="color: #56B6C2">+=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD; font-style: italic">else</span><span style="color: #ABB2BF">:</span></span>
<span class="line"><span style="color: #ABB2BF">                i </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> nxt[i] </span><span style="color: #7F848E; font-style: italic"># \u5C06nxt[i]\u4F4D\u7F6E\u548Cj\u4F4D\u7F6E\u5BF9\u9F50</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> i </span><span style="color: #56B6C2">==</span><span style="color: #ABB2BF"> m:</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">return</span><span style="color: #ABB2BF"> j </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> i </span><span style="color: #7F848E; font-style: italic"># \u8FD4\u56DE\u5B50\u4E32\u7684\u5DE6\u7AEF</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">return</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">NO_MATCH</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color: #ffffff"><code><span class="line"><span style="color: #0550AE">NO_MATCH</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #CF222E">-</span><span style="color: #0550AE">1</span></span>
<span class="line"></span>
<span class="line"><span style="color: #CF222E">def</span><span style="color: #24292F"> </span><span style="color: #8250DF">kmp</span><span style="color: #24292F">(p, s): </span><span style="color: #6E7781"># pattern \u6A21\u5F0F\u4E32, string \u76EE\u6807\u4E32</span></span>
<span class="line"><span style="color: #24292F">    m, n </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">len</span><span style="color: #24292F">(p), </span><span style="color: #0550AE">len</span><span style="color: #24292F">(s)</span></span>
<span class="line"><span style="color: #24292F">    i, j </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F">, </span><span style="color: #0550AE">0</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #6E7781"># \u9884\u5904\u7406</span></span>
<span class="line"><span style="color: #24292F">    nxt </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [</span><span style="color: #CF222E">-</span><span style="color: #0550AE">1</span><span style="color: #24292F">] </span><span style="color: #6E7781"># next \u9884\u5904\u7406\u8868</span></span>
<span class="line"><span style="color: #24292F">    k </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #CF222E">-</span><span style="color: #0550AE">1</span><span style="color: #24292F"> </span><span style="color: #6E7781"># \u4E0A\u4E00\u6B21\u9A8C\u8BC1\u7684\u524D\u7F00\u672B\u5C3E</span></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #CF222E">for</span><span style="color: #24292F"> x </span><span style="color: #CF222E">in</span><span style="color: #24292F"> </span><span style="color: #0550AE">range</span><span style="color: #24292F">(</span><span style="color: #0550AE">1</span><span style="color: #24292F">, m):</span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">while</span><span style="color: #24292F"> k </span><span style="color: #CF222E">&gt;=</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F"> </span><span style="color: #CF222E">and</span><span style="color: #24292F"> p[x</span><span style="color: #CF222E">-</span><span style="color: #0550AE">1</span><span style="color: #24292F">] </span><span style="color: #CF222E">!=</span><span style="color: #24292F"> p[k]:</span></span>
<span class="line"><span style="color: #24292F">            k </span><span style="color: #CF222E">=</span><span style="color: #24292F"> nxt[k] </span><span style="color: #6E7781"># \u5728 k \u5904\u5931\u914D</span></span>
<span class="line"><span style="color: #24292F">        k </span><span style="color: #CF222E">+=</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F"> </span><span style="color: #6E7781"># k \u5904\u5339\u914D\u6210\u529F\uFF0C\u524D\u7F00\u957F\u5EA6\u53EF\u4EE5\u9012\u589E 1</span></span>
<span class="line"><span style="color: #24292F">        </span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">if</span><span style="color: #24292F"> p[k] </span><span style="color: #CF222E">==</span><span style="color: #24292F"> p[x]:</span></span>
<span class="line"><span style="color: #24292F">            nxt.append(nxt[k]) </span><span style="color: #6E7781"># \u4F18\u5316</span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">else</span><span style="color: #24292F">: nxt.append(k)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #6E7781"># \u6BD4\u8F83</span></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #CF222E">while</span><span style="color: #24292F"> i </span><span style="color: #CF222E">&lt;</span><span style="color: #24292F"> m </span><span style="color: #CF222E">and</span><span style="color: #24292F"> j </span><span style="color: #CF222E">&lt;</span><span style="color: #24292F"> n:</span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">if</span><span style="color: #24292F"> p[i] </span><span style="color: #CF222E">==</span><span style="color: #24292F"> s[j]: </span><span style="color: #6E7781"># \u5339\u914D\u6210\u529F</span></span>
<span class="line"><span style="color: #24292F">            i </span><span style="color: #CF222E">+=</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">; j </span><span style="color: #CF222E">+=</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">else</span><span style="color: #24292F">: </span><span style="color: #6E7781"># \u5339\u914D\u5931\u8D25</span></span>
<span class="line"><span style="color: #24292F">            </span><span style="color: #CF222E">if</span><span style="color: #24292F"> nxt[i] </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #CF222E">-</span><span style="color: #0550AE">1</span><span style="color: #24292F">: </span><span style="color: #6E7781"># \u5411\u540E\u79FB\u52A81\u4F4D</span></span>
<span class="line"><span style="color: #24292F">                i </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F">; j </span><span style="color: #CF222E">+=</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span></span>
<span class="line"><span style="color: #24292F">            </span><span style="color: #CF222E">else</span><span style="color: #24292F">:</span></span>
<span class="line"><span style="color: #24292F">                i </span><span style="color: #CF222E">=</span><span style="color: #24292F"> nxt[i] </span><span style="color: #6E7781"># \u5C06nxt[i]\u4F4D\u7F6E\u548Cj\u4F4D\u7F6E\u5BF9\u9F50</span></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #CF222E">if</span><span style="color: #24292F"> i </span><span style="color: #CF222E">==</span><span style="color: #24292F"> m:</span></span>
<span class="line"><span style="color: #24292F">        </span><span style="color: #CF222E">return</span><span style="color: #24292F"> j </span><span style="color: #CF222E">-</span><span style="color: #24292F"> i </span><span style="color: #6E7781"># \u8FD4\u56DE\u5B50\u4E32\u7684\u5DE6\u7AEF</span></span>
<span class="line"><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">NO_MATCH</span></span>
<span class="line"></span></code></pre></div></code></pre>
<h2 id="\u53C2\u8003\u8D44\u6599" tabindex="-1">\u53C2\u8003\u8D44\u6599</h2>
<ul>
<li><a href="https://blog.csdn.net/v_july_v/article/details/7041827" target="_blank" rel="noopener">July\uFF0C\u4ECE\u5934\u5230\u5C3E\u5F7B\u5E95\u7406\u89E3 KMP\uFF0C2014</a></li>
<li>\u88D8\u5B97\u71D5\uFF0C\u6570\u636E\u7ED3\u6784\u4E0E\u7B97\u6CD5\uFF1APython \u8BED\u8A00\u63CF\u8FF0\uFF0C2018</li>
</ul>
</div>`})}}};export{g as category,h as date,w as default,d as keywords,x as math,y as tags,r as title};
